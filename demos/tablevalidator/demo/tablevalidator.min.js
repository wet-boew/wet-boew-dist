/*!
 * Web Experience Toolkit (WET) / Boîte à outils de l'expérience Web (BOEW)
 * wet-boew.github.io/wet-boew/License-en.html / wet-boew.github.io/wet-boew/Licence-fr.html
 * v4.0.11-development - 2015-01-28
 *
 *//*!
 * Web Experience Toolkit ( WET ) / Boîte à outils de l'expérience Web ( BOEW )
 * wet-boew.github.io/wet-boew/License-eng.html / wet-boew.github.io/wet-boew/Licence-fra.html
 */
!function(a,b){"use strict";function c(b){var c={};return a("#chkHassum").is(":checked")&&b.addClass("hassum"),c.accessibilty=a("#access-1").is(":checked")?"auto":a("#access-2").is(":checked")?"scope":"headers",c.prefix=a("#idprefix").val(),a("#uniqueprefix").is(":checked")&&(c.prefix="tbl"+((new Date).getTime()+"-").substring(5)),c}var d="wb-tblvalidator",e="."+d,f=".wb-tableparser",g="passiveparse"+f,h="parsecomplete"+f,i=b.doc,j="idsheaders"+e,k="scope"+e,l="simple"+e,m="showhtml"+e,n="log"+e,o="#formtablevalidator",p={"%tblparser1":"Only table can be parsed with this parser","%tblparser2":"The table was already parsed.","%tblparser3":"The first colgroup must be spanned to represent the header column group","%tblparser3Tech":6,"%tblparser4":" You have an invalid cell inside a row description","%tblparser4Tech":4,"%tblparser5":"You need at least one data colgroup, review your table structure","%tblparser5Tech":8,"%tblparser6":"The Lowest column group level have been found, You may have an error in you column structure","%tblparser6Tech":9,"%tblparser7":"The initial colgroup should group all the header, there are no place for any data cell","%tblparser7Tech":4,"%tblparser9":"Error in you header row group, there are cell that are crossing more than one colgroup","%tblparser9Tech":4,"%tblparser10":"The header group cell used to represent the data at level must encapsulate his group","%tblparser10Tech":7,"%tblparser12":"Last summary row group already found","%tblparser12Tech":3,"%tblparser13":"Error, Row group not calculated","%tblparser14":"You can not have a summary at level under 0, add a group header or merge a tbody togheter","%tblparser14Tech":3,"%tblparser15":"tr element need to only have th or td element as his child","%tblparser16":"The row do not have a good width","%tblparser16Tech":12,"%tblparser17":"The layout cell is not empty","%tblparser17Tech":11,"%tblparser18":"Row group header not well structured.","%tblparser18Tech":7,"%tblparser21":"Move the row used as the column cell heading in the thead row group","%tblparser21Tech":7,"%tblparser23":"Avoid the use of have paralel row headers, it's recommended do a cell merge to fix it","%tblparser23Tech":3,"%tblparser24":"For a data row, the heading hiearchy need to be the Generic to the specific","%tblparser24Tech":3,"%tblparser25":"You have a problematic key cell","%tblparser25Tech":0,"%tblparser26":"You can not define any row before the thead group","%tblparser26Tech":12,"%tblparser27":"thead element need to only have tr element as his child","%tblparser27Tech":12,"%tblparser29":"You cannot span cell in 2 different rowgroup","%tblparser29Tech":12,"%tblparser30":"Use the appropriate table markup","%tblparser30Tech":12,"%tblparser31":"Internal Error, Number of virtual column must be set [ function processColgroup( ) ]","%tblparser32":"Check your row cell headers structure","%tblparser32Tech":3,"%tblparser34":"Mark properly your data row group.","%tblparser34Tech":1,"%tblparser35":"Column, col element, are not correctly defined","%tblparser35Tech":12},q=["keycell-techniques.html","rowgrouping-techniques.html","summariesrowgroup-techniques.html","headerrowgroupstructure-techniques.html","rowheader-description-techniques.html","rowgroupheader-description-techniques.html","colgroupheader-techniques.html","headercolgroupstructure-techniques.html","datacolgroup-techniques.html","colgroupsummary-techniques.html","colheader-description-techniques.html","layoutcell-techniques.html","http://www.w3.org/TR/html5/spec.html"],r=["Defining a Key Cell","Defining a Data Row Group in a Data Table","Summaries a Data Row Group in a Data Table","Structuring the Header Row in a Data Table","Describing a Row Header Cell in a Data Table","Describing a Row Group Header Cell in a Data Table","Defining Column Group Header in a Data Table","Structuring the Header Column Cell in a Data Table","Defining a Data Column Group in a Data Table","Summaries a Data Column Group in a Data Table","Describing a Column Header Cell in a Data Table","Defining a Layout Cell in a Data Table","HTML5 Specification"];i.on("submit",o,function(){return!1}),i.on(m,"#visualoutput > table:eq( 0 )",function(b){var c,d,e=b.target,f=a("#results");return b.currentTarget!==e?!0:(c=a(e),d=("<table>"+c.html()+"</table>").replace(/<col>/g,"<col />").replace(/<br>/g,"<br />").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"),f.html("<pre class='prettyprint'><code>"+d+"</code></pre>"),"function"==typeof window.prettyPrint&&window.prettyPrint(),void a(o).trigger({type:n,logtype:"Information",logmessage:"Result Displayed"}))}),i.on(j,"#visualoutput > table:eq( 0 )",function(b){var c,d,e,f,g,h,i,j,k,l,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=b.target,F=c,G=!1,H=!1;if(b.currentTarget!==E)return!0;for(a(o).trigger({type:n,logtype:"Information",logmessage:"Accessibility Strategy: Ids/Headers"}),c=a(E),e=c.data().tblparser,d=c.data().wbvalidateoptions,p=d.prefix||"wb-tablevalidated",f=0;f<e.theadRowStack.length;f+=1)for(k=e.theadRowStack[f],j=0;j<k.cell.length;j+=1)l=k.cell[j],1!==l.type&&7!==l.type||j>0&&l.uid===k.cell[j-1].uid||f>0&&l.uid===e.theadRowStack[f-1].cell[j].uid||(i=a(l.elem).attr("id"),(void 0===i||""===i||G)&&(i=p+l.uid,a(l.elem).attr("id",i)),f>0&&(q=a(e.theadRowStack[f-1].cell[j].elem).attr("id"),void 0!==a(e.theadRowStack[f-1].cell[j].elem).attr("headers")&&(q=a(e.theadRowStack[f-1].cell[j].elem).attr("headers")+" "+q),a(l.elem).attr("headers",q),(void 0===a(l.elem).attr("headers")||""===a(l.elem).attr("headers"))&&a(l.elem).removeAttr("headers")),l.descCell&&(a(l.descCell.elem).attr("headers",i),(void 0===a(l.descCell.elem).attr("headers")||""===a(l.descCell.elem).attr("headers"))&&a(l.descCell.elem).removeAttr("headers"),r=a(l.descCell.elem).attr("id"),(void 0===r||""===r||G)&&a(l.descCell.elem).attr("id",r),a(l.elem).attr("aria-describedby",r)));for(f=0;f<e.row.length;f+=1){if(k=e.row[f],s="",t="",u="",v="",k.headerset&&!k.idsrowheaders){for(j=0;j<k.headerset.length;j+=1)i=a(k.headerset[j].elem).attr("id"),(void 0===i||""===i||G)&&(i=p+k.headerset[j].uid,a(k.headerset[j].elem).attr("id",i)),s=s?s+" "+i:i;k.idsrowheaders=s}if(k.header)for(j=0;j<k.header.length;j+=1)i=a(k.header[j].elem).attr("id"),(void 0===i||""===i||G)&&(i=p+k.header[j].uid,a(k.header[j].elem).attr("id",i)),t=t?t+" "+i:i;for(t=k.idsrowheaders?k.idsrowheaders+" "+t:t,j=0;j<k.cell.length;j+=1)if(!k.cell[j].processed&&(0===j||j>0&&k.cell[j].uid!==k.cell[j-1].uid)){if(l=k.cell[j],w="",l.col&&!l.col.dataheaders){if(x=l.col,y="",z="",x.headerLevel)for(g=0;g<x.headerLevel.length;g+=1)i=a(x.headerLevel[g].elem).attr("id"),(void 0===i||""===i||G)&&(i=p+x.headerLevel[g].uid,a(x.headerLevel[g].elem).attr("id",i)),z=z?z+" "+i:i;if(x.header)for(g=0;g<x.header.length;g+=1)i=a(x.header[g].elem).attr("id"),(void 0===i||""===i||G)&&(i=p+x.header[g].uid,a(x.header[g].elem).attr("id",i)),y=y?y+" "+i:i;x.dataheaders=z?z+" "+y:y}if(l.col&&l.col.dataheaders&&(w=l.col.dataheaders),1===l.type&&(a(l.elem).attr("headers",(w?w:"")+(k.idsrowheaders&&w?" ":"")+(k.idsrowheaders?k.idsrowheaders:"")+(k.idsrowheaders&&v||w&&v&&!k.idsrowheaders?" ":"")+(v?v:"")),(void 0===a(l.elem).attr("headers")||""===a(l.elem).attr("headers"))&&a(l.elem).removeAttr("headers"),C=a(l.elem).attr("id"),(void 0===C||""===C||G)&&(C=p+l.uid,a(l.elem).attr("id",C)),v=(""!==v?v+" ":"")+C),2===l.type||3===l.type){if(u=t,l.addcolheaders)for(g=0;g<l.addcolheaders.length;g+=1)i=a(l.addcolheaders[g].elem).attr("id"),(void 0===i||""===i||G)&&(i=p+l.addcolheaders[g].uid,a(l.addcolheaders[g].elem).attr("id",i)),w=w?w+" "+i:i;if(l.addrowheaders)for(g=0;g<l.addrowheaders.length;g+=1)i=a(l.addrowheaders[g].elem).attr("id"),(void 0===i||""===i||G)&&(i=p+l.addrowheaders[g].uid,a(l.addrowheaders[g].elem).attr("id",i)),u=u?u+" "+i:i;a(l.elem).attr("headers",(w?w:"")+(u&&w?" ":"")+(u?u:"")),(void 0===a(l.elem).attr("headers")||""===a(l.elem).attr("headers"))&&a(l.elem).removeAttr("headers")}if(4===l.type||5===l.type){if(D="",l.describe)for(g=0;g<l.describe.length;g+=1)i=a(l.describe[g].elem).attr("id"),(void 0===i||""===i||G)&&(i=p+l.describe[g].uid,a(l.describe[g].elem).attr("id",i)),D=D?D+" "+i:i,5!==l.type||a(l.describe[g].elem).attr("aria-describedby")||(i=a(l.elem).attr("id"),(void 0===i||""===i||G)&&(i=p+l.uid,a(l.elem).attr("id",i)),a(l.describe[g].elem).attr("aria-describedby",i));4!==l.type?(a(l.elem).attr("headers",(w?w:"")+(w&&D?" ":"")+(D||"")),(void 0===a(l.elem).attr("headers")||""===a(l.elem).attr("headers"))&&a(l.elem).removeAttr("headers")):a(l.elem).attr("aria-describedby")||(a(l.elem).attr("aria-describedby",D||""),a(l.elem).attr("headers",w||""),(void 0===a(l.elem).attr("headers")||""===a(l.elem).attr("headers"))&&a(l.elem).removeAttr("headers"))}l.processed=!0}}for(f=0;f<e.lstrowgroup.length;f+=1)if(e.lstrowgroup[f].headerlevel.length>0)for(j=0;j<e.lstrowgroup[f].headerlevel.length;j+=1)e.lstrowgroup[f].headerlevel[j].descCell&&(A=a(e.lstrowgroup[f].headerlevel[j].descCell.elem).attr("id"),(void 0===A||""===A||G)&&(A=p+e.lstrowgroup[f].headerlevel[j].descCell.uid,a(e.lstrowgroup[f].headerlevel[j].descCell.elem).attr("id",A)),a(e.lstrowgroup[f].headerlevel[j].elem).attr("aria-describedby",A),i=a(e.lstrowgroup[f].headerlevel[j].elem).attr("id"),(void 0===i||""===i||G)&&(i=p+e.lstrowgroup[f].headerlevel[j].uid,a(e.lstrowgroup[f].headerlevel[j].elem).attr("id",i)),a(e.lstrowgroup[f].headerlevel[j].descCell.elem).attr("headers",i));for(f=0;f<e.colgroup.length;f+=1)if(void 0===e.colgroup[f].elem){for(h=a("<colgroup></colgroup>"),j=0;j<e.colgroup[f].col.length;j+=1)B=a("<col />"),a(h).append(B),e.colgroup[f].col[j].elem=a(B).get(0),a(B).data().tblparser=e.colgroup[f].col[j];H?a(H).after(h):a(F).has("caption")?a("caption:eq( 0 )",F).after(h):a(F).prepend(h),H=h,e.colgroup[f].elem=a(h).get(0),a(h).data().tblparser=e.colgroup[f]}else for(h=e.colgroup[f].elem,a(h).removeAttr("span"),j=0;j<e.colgroup[f].col.length;j+=1)void 0===e.colgroup[f].col[j].elem&&(B=a("<col />"),a(h).append(B),e.colgroup[f].col[j].elem=a(B).get(0),a(B).data().tblparser=e.colgroup[f].col[j]);c.trigger(m)}),i.on(k,"#visualoutput > table:eq( 0 )",function(b){var c,d,e,f,g=b.target;if(b.currentTarget!==g)return!0;for(a(o).trigger({type:n,logtype:"Information",logmessage:"Accessibility Strategy: Scope"}),c=a(g),d=c.data().tblparser,e=0;e<d.lstrowgroup.length;e+=1)for(d.lstrowgroup[e].headerlevel&&d.lstrowgroup[e].headerlevel[0]&&a(d.lstrowgroup[e].headerlevel[0].elem).attr("scope","rowgroup"),f=0;f<d.lstrowgroup[e].row.length;f+=1)1===d.lstrowgroup[e].row[f].cell[0].type&&a(d.lstrowgroup[e].row[f].cell[0].elem).attr("scope","row");if(2===d.theadRowStack.length)for(e=1===d.colgroup[0].type?d.colgroup[0].end:0;e<d.theadRowStack[0].cell.length;e+=1)(0===e||d.theadRowStack[0].cell[e-1].uid!==d.theadRowStack[0].cell[e].uid)&&a(d.theadRowStack[0].cell[e].elem).attr("scope","colgroup");if(1===d.theadRowStack.length||2===d.theadRowStack.length)for(e=0;e<d.theadRowStack[1===d.theadRowStack.length?0:1].cell.length;e+=1)1===d.theadRowStack[1===d.theadRowStack.length?0:1].cell[e].type&&a(d.theadRowStack[1===d.theadRowStack.length?0:1].cell[e].elem).attr("scope","col");c.trigger(m)}),i.on(l,"#visualoutput > table:eq( 0 )",function(b){var c,d=b.target;return b.currentTarget!==d?!0:(a(o).trigger({type:n,logtype:"Information",logmessage:"Accessibility Strategy: Nothing"}),c=a(d),void c.trigger(m))}),i.on(h,"#visualoutput > table:eq( 0 )",function(b){var c,d,e,f,g=b.target;if(b.currentTarget!==g)return!0;if(c=a(g),e=c.data().tblparser,d=c.data().wbvalidateoptions,"headers"===d.accessibilty||e.theadRowStack.length>2||e.desccell||e.keycell||2===e.colgroup[0].type&&e.colgroup[0].col.length>2)return void c.trigger(j);for(f=0;f<e.lstrowgroup.length;f+=1)if(!(2===e.lstrowgroup[f].type&&e.lstrowgroup[f].level<=2||3===e.lstrowgroup[f].type&&0===e.lstrowgroup[f].level))return void c.trigger(j);if(e.colgroup[0]&&1===e.colgroup[0].type&&6===e.theadRowStack[0].cell[0].type)f=e.colgroup[0].end;else{if(2!==e.colgroup[0].type)return void c.trigger(j);f=0}for(f;f<e.theadRowStack[0].cell.length;f+=1)if(e.theadRowStack[0].cell[f].colgroup&&(e.theadRowStack[0].cell[f].colgroup.start===e.theadRowStack[0].cell[f].colgroup.end||e.theadRowStack[0].cell[f].colgroup.start!==e.theadRowStack[0].cell[f].colpos||e.theadRowStack[0].cell[f].colgroup.end!==e.theadRowStack[0].cell[f].colpos+e.theadRowStack[0].cell[f].width-1||2!==e.theadRowStack[0].cell[f].colgroup.type))return void c.trigger(j);return"auto"===d.accessibilty&&e.theadRowStack.length<=1&&(1===e.lstrowgroup.length||2===e.lstrowgroup[0].type&&3===e.lstrowgroup[1].type&&0===e.lstrowgroup[1].level)?void c.trigger(l):"auto"===d.accessibilty||"scope"===d.accessibilty?void c.trigger(k):void c.trigger(j)}),i.on("error"+f,"#visualoutput > table:eq( 0 )",function(b){var c,d=b.err,e="#"+d+", ",f="";f=p["%tblparser"+d],void 0!==p["%tblparser"+d+"Tech"]&&(c=p["%tblparser"+d+"Tech"],f="<a href='"+q[c]+"' title='"+r[c]+"'>"+f+"</a>"),e+=f,a(o).trigger({type:n,logtype:"Error",logmessage:e})}),i.on("warning"+f,"#visualoutput > table:eq( 0 )",function(b){var c,d=b.err,e="#"+d+", ",f="";f=p["%tblparser"+d],void 0!==p["%tblparser"+d+"Tech"]&&(c=p["%tblparser"+d+"Tech"],f="<a href='"+q[c]+"' title='"+r[c]+"'>"+f+"</a>"),e+=f,a(o).trigger({type:n,logtype:"Warning",logmessage:e})}),i.on("click","#validatetable",function(){var d;a("#visualoutput").empty(),a("#errors").empty(),a("#visualoutput").append(a("#inputsourcecode").val()),d=a("#visualoutput > table:eq( 0 )"),d.length||(a(o).trigger({type:n,logtype:"Error",logmessage:"No HTML Table code provided in input"}),alert("Please add HTML Table code"),a("#inputsourcecode").focus()),a("#chkCleanMarkup").is(":checked")||(a("[ headers ]",d).each(function(){a(this).removeAttr("headers")}),a("[ aria-describedby ]",d).each(function(){a(this).removeAttr("aria-describedby")}),a("[ id ]",d).each(function(){a(this).removeAttr("id")}),a("[ scope ]",d).each(function(){a(this).removeAttr("scope")}),a("[ class ]",d).each(function(){a(this).removeAttr("class")})),d.data().wbvalidateoptions=c(d),Modernizr.load({load:["site!deps/tableparser"+b.getMode()+".js"],complete:function(){d.trigger(g)}}),d.addClass("table table-lined")}),i.on(n,o,function(b){var c="<li><strong>"+b.logtype+":</strong> "+b.logmessage+"</li>";a("#errorslist").length||a("#errors").append("<ul id='errorslist'></ul>"),a("#errorslist").append(c)})}(jQuery,wb);